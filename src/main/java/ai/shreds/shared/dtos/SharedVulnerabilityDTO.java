package ai.shreds.shared.dtos;

import jakarta.validation.constraints.NotBlank;
import jakarta.validation.constraints.NotNull;
import lombok.AllArgsConstructor;
import lombok.Builder;
import lombok.Data;
import lombok.NoArgsConstructor;

/**
 * Data Transfer Object for vulnerability information.
 * Contains details about a security vulnerability found during scanning.
 */
@Data
@Builder
@NoArgsConstructor
@AllArgsConstructor
public class SharedVulnerabilityDTO {

    @NotBlank(message = "Vulnerability type cannot be blank")
    private String type;

    @NotBlank(message = "Severity level cannot be blank")
    private String severity;

    @NotBlank(message = "Description cannot be blank")
    private String description;

    @NotNull(message = "Location cannot be null")
    private String location;

    /**
     * Creates a high severity vulnerability.
     *
     * @param type Vulnerability type
     * @param description Detailed description
     * @param location Where the vulnerability was found
     * @return A high severity vulnerability DTO
     */
    public static SharedVulnerabilityDTO highSeverity(String type, String description, String location) {
        return SharedVulnerabilityDTO.builder()
                .type(type)
                .severity("HIGH")
                .description(description)
                .location(location)
                .build();
    }

    /**
     * Creates a medium severity vulnerability.
     *
     * @param type Vulnerability type
     * @param description Detailed description
     * @param location Where the vulnerability was found
     * @return A medium severity vulnerability DTO
     */
    public static SharedVulnerabilityDTO mediumSeverity(String type, String description, String location) {
        return SharedVulnerabilityDTO.builder()
                .type(type)
                .severity("MEDIUM")
                .description(description)
                .location(location)
                .build();
    }

    /**
     * Creates a low severity vulnerability.
     *
     * @param type Vulnerability type
     * @param description Detailed description
     * @param location Where the vulnerability was found
     * @return A low severity vulnerability DTO
     */
    public static SharedVulnerabilityDTO lowSeverity(String type, String description, String location) {
        return SharedVulnerabilityDTO.builder()
                .type(type)
                .severity("LOW")
                .description(description)
                .location(location)
                .build();
    }
}
